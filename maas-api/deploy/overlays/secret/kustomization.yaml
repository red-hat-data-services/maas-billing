apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: maas-api-secrets-provider

resources:
- ../../base/

patches:
- path: patches/secrets-provider.yaml
- path: patches/api-key-env-var.yaml
- path: patches/clusterrole.yaml
  target:
    kind: ClusterRole
    name: maas-api

# See https://kubernetes.io/docs/tasks/configmap-secret/managing-secret-using-kustomize/
secretGenerator:
  - name: maas-api-admin-secret
    envs:
      - admin.secret.env # secret for the admin API key, e.g. `admin-api-key=letmein`
